---
layout: post 
title: "Training a Speech Synthesizer: A Fun Deep Learning Project"
blog_url: https://blog.aqnichol.com/2025/01/22/training-a-speech-synthesizer/ 
---



## Key Points

- The author trained a custom speech synthesizer using modern deep learning tools, specifically VQ-VAE and an autoregressive Transformer with Rotary Embeddings.
- Instead of using real-world audio data, the project leveraged synthetic data generated by Apple's Siri speech synthesizer, fed with 1M examples of short text strings.
- The data collection process was simple: 100 ebooks from Project Gutenberg were processed using the Mac's built-in `say` command-line tool to create ~1.5M audio files, reduced to 1M after deduplication.
- VQ-VAE was used to compress raw audio data (24kHz) into discrete codes at a lower bitrate (96Hz), making it more manageable for the Transformer model.
- Normalizing flows were experimented with to 'fill in the blanks' during decoding, though they introduced challenges and weren't fully optimized.
- Training the VQ codes was the most difficult part, with issues like instability, bugs in Apple's Metal Performance Shaders, and poor quality even after tuning.
- The Transformer model trained quickly and stably, but initially produced odd artifacts due to inconsistent data preprocessing (like extra sounds after prompts).
- The model showed surprising strengths, such as pronouncing out-of-distribution words like 'DALL-E' and handling tongue twisters well, though it struggled with large numbers and some simple prompts.
- All training was done on a single Mac Studio using Swift and the Honeycrisp deep learning framework over a few weeks.
- The project highlights both the potential and quirks of training speech synthesizers with synthetic data and modern deep learning techniques.

## Key Topics Discussed

Alright, folks, let’s dive into something super cool: training a speech synthesizer! If you’ve ever thought computers would be even more amazing if they could chat with you like a real person, you’re not alone. Speech synthesis has been a hot topic for decades, and today, thanks to deep learning, it’s easier than ever to build your own. That’s exactly what the author of this blog post did, and let me tell you, it’s a fascinating journey into how modern AI tools can turn raw text into spoken words—right from your Mac Studio, no less! Here’s how they pulled it off and what they learned along the way, which is both inspiring and hilarious at times, trust me on that one!

